{
  "hash": "28cd10360aeae34bf56f919f60219bf1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-Home Exercise 01\"\nauthor: \"Chun-Han\"\ndate: \"February 2, 2026\"\ndate-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n---\n\n## Overview\n\nThis report analyzes income inequality among rural informal labourers in Northern Vietnam. Leveraging tidyverse for data wrangling and ggplot2 for visual analytics, we address key socio-economic questions through four progressive lenses:\n\n1.  **Macro Context**: Demographics and income distribution patterns.\n\n2.  **Structural Gaps**: The influence of ethnicity, gender, and livelihood diversity.\n\n3.  **Micro Influencers**: Returns on education, vocational training, and credit access.\n\n4.  **Social Outlook**: Linking policy priorities to rural development perceptions.\n\n## 1 Getting Started\n\n### 1.1 Installing and loading the packages\n\n| Library | Description |\n|-------------|-----------------------------------------------------------|\n| tidyverse | A collection of core packages designed for data science, used extensively for data preparation and wrangling. |\n| readxl | Allows R to read Excel files (.xlsx). |\n| patchwork | For arranging multiple ggplot2 figures into a composite figure. |\n| ggthemes | Provides extra themes, geoms, and scales for ggplot2. |\n| scales | Supplies scale functions and tools for customizing axes, labels, and legends in ggplot2. |\n| ggdist | An extension of ggplot2 for visualising distributions and uncertainty, useful for half-violin or raincloud plots. |\n| plotly | R library for plotting interactive statistical graphs |\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, readxl, patchwork, ggthemes, scales, ggdist, plotly)\n```\n:::\n\n\n### 1.2 Data import\n\n[The dataset](https://www.sciencedirect.com/science/article/pii/S235234092100576X) used in this study is derived from a socio-economic survey of 725 informal labourers across five provinces in the Northern Mountainous Region of Vietnam. \nThe data consists of 725 observations and 30 variables, categorized into six key dimensions: Characteristics (C), Income Types (T), Impact Factors (F), Living Conditions (L), Policy Opinions (P), and Social Assessments (A).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nraw_df <- read_excel(\"data/Upload for elsiver.xlsx\",\n                     sheet = 1,\n                     na = c(\"\", \"NA\"))\n```\n:::\n\n\n### 1.3 Filtering data for selected variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\nselected_df <- raw_df %>%\n  select(\n    CPRO, CGEN, CRAC, CJOB, CQUI,        \n    TEIN, TAIN, TSII, TOIN,              \n    FEDU, FVTP, FCRA, FTAP,              \n    LWDA,                                \n    starts_with(\"PPO\"),                  \n    ARO4,                                \n    starts_with(\"LHO\")                \n  )\n```\n:::\n\n\n### 1.4 Data Preprocessing\n\n#### 1.4.1 Checking Duplicate Rows \n\nUsing the `duplicated()` function to see whether there are duplicate entries in the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nselected_df[duplicated(selected_df),]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 24\n   CPRO CGEN   CRAC  CJOB  CQUI  TEIN  TAIN  TSII  TOIN  FEDU  FVTP  FCRA  FTAP\n  <dbl> <chr> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>\n1     3 1         2     1     5    24    24     0     0     0     1     1     1\n2     3 1         2     1     5    22    22     0     0     0     1     1     1\n3     3 1         2     1     5    22    22     0     0     0     1     1     1\n4     3 1         2     1     4    26    26     0     0     0     1     1     1\n5     5 1         1     1     5    18     7    11     0     0     1     1     1\n# ℹ 11 more variables: LWDA <dbl>, PPO1 <dbl>, PPO2 <dbl>, PPO3 <dbl>,\n#   PPO4 <dbl>, PPO5 <dbl>, ARO4 <chr>, LHO1 <dbl>, LHO2 <dbl>, LHO3 <dbl>,\n#   LHO4 <dbl>\n```\n\n\n:::\n:::\n\n\n:::callout-note\n\nAlthough some identical rows appear after performing feature selection, we have deliberately chosen to retain all records. In a survey targeting a highly homogeneous population (such as informal labourers in the same mountainous region), it is common for different respondents to share identical socio-economic profiles across key indicators like income, gender, and career. Removing these records after reducing the feature space would lead to an artificial loss of sample density and bias the statistical representation of these specific demographic groups.\n:::\n\n#### 1.4.2 Checking Missing Value\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_na <- colSums(is.na(selected_df))\ncheck_na\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCPRO CGEN CRAC CJOB CQUI TEIN TAIN TSII TOIN FEDU FVTP FCRA FTAP LWDA PPO1 PPO2 \n   0    0    0   49    4    1    1    6    0   23   23    2  102  160  209  230 \nPPO3 PPO4 PPO5 ARO4 LHO1 LHO2 LHO3 LHO4 \n  88   99  106  111  512  402  616  653 \n```\n\n\n:::\n:::\n\n\nRecognizing that different variables carry distinct statistical weight, we implemented a Categorized Imputation Strategy\n\n- For Core Metrics (TEIN): We applied deletion to maintain a solid analytical baseline. \n\n- For Categorical Factors (CJOB, FEDU): We recoded missing entries as \"Unknown\" or \"Not Disclosed\". This is particularly critical for the Career (CJOB) variable, as it preserves 49 observations that still hold valuable income data.\n\n- For Binary Indicators (LHO series): NA values were treated as a negative response (0).\n\n- For Subjective Opinions (PPO): Missing values were labeled as \"Not Answered\".\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfinal_df <- selected_df %>%\n  filter(!is.na(TEIN)) %>%\n  \n  mutate(across(c(CGEN, CRAC, CJOB, CQUI, FEDU, FVTP, FCRA, FTAP, ARO4), \n                ~replace_na(as.character(.), \"Unknown\"))) %>%\n\n  mutate(across(starts_with(\"PPO\"), \n                ~replace_na(as.character(.), \"Not Answered\"))) %>%\n  \n  mutate(across(starts_with(\"LHO\"), \n                ~replace_na(as.numeric(.), 0)))\n```\n:::\n\n\n#### 1.4.3 Renaming Columns and Transforming Feature \n\n\n::: {.cell}\n\n```{.r .cell-code}\nclean_df <- final_df %>%\n  rename(\n    total_income         = TEIN,\n    agri_income          = TAIN,\n    service_industry_inc = TSII,\n    other_income         = TOIN,\n    working_days         = LWDA,\n    policy_training      = PPO1,\n    policy_agri_chain    = PPO2,\n    policy_healthcare    = PPO3,\n    policy_elderly_care  = PPO4,\n    policy_urban_jobs    = PPO5,\n    wellbeing_improve    = ARO4,\n    house_cottage        = LHO1,\n    house_roofed         = LHO2,\n    house_solid          = LHO3,\n    house_buildings      = LHO4\n  ) %>%\n  \n  # Recoding values to labels\n  mutate(\n    province = factor(CPRO, levels = 1:5, \n                      labels = c(\"Tuyen Quang\", \"Quang Ninh\", \"Ha Giang\", \"Yen Bai\", \"Bac Giang\")),\n    gender   = factor(CGEN, levels = c(1, 2), labels = c(\"Male\", \"Female\")),\n    race     = factor(CRAC, levels = c(1, 2), labels = c(\"Kinh\", \"Minority\")),\n    \n    job_type = factor(CJOB, levels = c(1, 2, 3), \n                      labels = c(\"Agricultural\", \"Service/Industrial\", \"Other\")),\n    income_group = factor(CQUI, levels = c(5, 4, 3, 2, 1), \n                          labels = c(\"Lowest\", \"Second\", \"Middle\", \"Fourth\", \"Top\")),\n    \n    # Education and Micro-factors\n    education = factor(FEDU, levels = c(0, 1, 2, 3), \n                       labels = c(\"Primary\", \"Lower secondary\", \"Upper secondary\", \"Other\")),\n    training_status = factor(FVTP, levels = c(1, 2), labels = c(\"Short course\", \"Long course\")),\n    credit_status   = factor(FCRA, levels = c(1, 2), labels = c(\"Inaccessible\", \"Accessible\")),\n    tech_level      = factor(FTAP, levels = c(1, 2), labels = c(\"Low\", \"Adequate\")),\n    \n    # Binary\n    across(starts_with(\"house_\"), ~factor(., levels = c(0, 1), labels = c(\"No\", \"Yes\"))),\n    \n    # Recoding PPO & ARO scores\n    across(c(starts_with(\"policy_\"), wellbeing_improve), ~case_when(\n      . == \"1\" ~ \"Strongly Disagree\",\n      . == \"2\" ~ \"Disagree\",\n      . == \"3\" ~ \"Neutral\",\n      . == \"4\" ~ \"Agree\",\n      . == \"5\" ~ \"Strongly Agree\",\n      TRUE ~ \"No Opinion\"\n    ) %>% factor(levels = c(\"Strongly Disagree\", \"Disagree\", \"Neutral\", \"Agree\", \"Strongly Agree\", \"No Opinion\"))),\n    \n    # Feature Engineering\n    daily_wage = if_else(!is.na(working_days) & working_days > 0, total_income / working_days, NA_real_),\n    agri_inc_ratio = if_else(total_income > 0, agri_income / total_income, 0)\n  ) %>%\n  \n  # Remove original numerical columns\n  select(-CPRO, -CGEN, -CRAC, -CJOB, -CQUI, -FEDU, -FVTP, -FCRA, -FTAP)\n\n# Final Verification\nglimpse(clean_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 724\nColumns: 26\n$ total_income         <dbl> 37, 25, 33, 35, 36, 21, 35, 36, 38, 30, 58, 24, 3…\n$ agri_income          <dbl> 25, 22, 25, 30, 28, 17, 25, 28, 26, 22, 40, 24, 2…\n$ service_industry_inc <dbl> 7, 0, 0, 5, 0, 0, 0, 0, 12, 2, 0, 0, 0, 0, 0, 50,…\n$ other_income         <dbl> 5, 3, 8, 0, 8, 4, 10, 8, 0, 6, 18, 0, 9, 0, 2, 15…\n$ working_days         <dbl> 240, 350, 260, 300, 360, 360, 260, 260, 300, 300,…\n$ policy_training      <fct> Strongly Agree, Disagree, Strongly Agree, No Opin…\n$ policy_agri_chain    <fct> Disagree, Strongly Agree, Strongly Agree, No Opin…\n$ policy_healthcare    <fct> Neutral, Neutral, Strongly Disagree, No Opinion, …\n$ policy_elderly_care  <fct> Strongly Disagree, Strongly Disagree, Strongly Di…\n$ policy_urban_jobs    <fct> Neutral, Strongly Disagree, Strongly Disagree, No…\n$ wellbeing_improve    <fct> Neutral, Neutral, No Opinion, No Opinion, Disagre…\n$ house_cottage        <fct> No, Yes, No, Yes, No, No, No, No, No, No, No, No,…\n$ house_roofed         <fct> Yes, No, No, No, Yes, Yes, No, Yes, Yes, Yes, Yes…\n$ house_solid          <fct> No, No, No, No, No, No, Yes, No, No, No, No, No, …\n$ house_buildings      <fct> No, No, Yes, No, No, No, No, No, No, No, No, No, …\n$ province             <fct> Tuyen Quang, Tuyen Quang, Tuyen Quang, Tuyen Quan…\n$ gender               <fct> Male, Male, Female, Male, Female, Female, Male, M…\n$ race                 <fct> Minority, Minority, Minority, Minority, Minority,…\n$ job_type             <fct> Agricultural, Agricultural, Other, Agricultural, …\n$ income_group         <fct> Middle, Lowest, Middle, Middle, Middle, Second, T…\n$ education            <fct> Lower secondary, Primary, Lower secondary, Lower …\n$ training_status      <fct> Short course, Short course, Short course, Short c…\n$ credit_status        <fct> Inaccessible, Accessible, Inaccessible, Inaccessi…\n$ tech_level           <fct> Low, Low, Adequate, NA, Adequate, Adequate, Adequ…\n$ daily_wage           <dbl> 0.15416667, 0.07142857, 0.12692308, 0.11666667, 0…\n$ agri_inc_ratio       <dbl> 0.6756757, 0.8800000, 0.7575758, 0.8571429, 0.777…\n```\n\n\n:::\n:::\n\n\n\n## 2 Visualization\n\n### 2.1 \n\n::: panel-tabset\n### Plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-44899a1b2b64733dd077\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-44899a1b2b64733dd077\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.70000000000000007,0.70000000000000018],\"base\":[0.075342465753424653,0.068493150684931503],\"x\":[1,2],\"y\":[0.58904109589041098,0.26712328767123289],\"text\":[\"<b>Province: <\\/b>Bac Giang (Total N=146)<br><b>Group: <\\/b>Kinh - Male<br><b>Count: <\\/b>86 persons<br><b>Share of Province: <\\/b>58.9%\",\"<b>Province: <\\/b>Bac Giang (Total N=146)<br><b>Group: <\\/b>Minority - Male<br><b>Count: <\\/b>39 persons<br><b>Share of Province: <\\/b>26.7%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(44,127,184,0.8)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Male\",\"legendgroup\":\"Male\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.70000000000000007,0.70000000000000018],\"base\":[0.042553191489361701,0.1773049645390071],\"x\":[1,2],\"y\":[0.18439716312056736,0.5957446808510638],\"text\":[\"<b>Province: <\\/b>Ha Giang (Total N=141)<br><b>Group: <\\/b>Kinh - Male<br><b>Count: <\\/b>26 persons<br><b>Share of Province: <\\/b>18.4%\",\"<b>Province: <\\/b>Ha Giang (Total N=141)<br><b>Group: <\\/b>Minority - Male<br><b>Count: <\\/b>84 persons<br><b>Share of Province: <\\/b>59.6%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(44,127,184,0.8)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Male\",\"legendgroup\":\"Male\",\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.70000000000000007,0.70000000000000018],\"base\":[0.25,0.076388888888888895],\"x\":[1,2],\"y\":[0.38888888888888884,0.28472222222222221],\"text\":[\"<b>Province: <\\/b>Quang Ninh (Total N=144)<br><b>Group: <\\/b>Kinh - Male<br><b>Count: <\\/b>56 persons<br><b>Share of Province: <\\/b>38.9%\",\"<b>Province: <\\/b>Quang Ninh (Total N=144)<br><b>Group: <\\/b>Minority - Male<br><b>Count: <\\/b>41 persons<br><b>Share of Province: <\\/b>28.5%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(44,127,184,0.8)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Male\",\"legendgroup\":\"Male\",\"showlegend\":false,\"xaxis\":\"x3\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.70000000000000007,0.70000000000000018],\"base\":[0.073333333333333334,0.10666666666666667],\"x\":[1,2],\"y\":[0.32666666666666666,0.49333333333333329],\"text\":[\"<b>Province: <\\/b>Tuyen Quang (Total N=150)<br><b>Group: <\\/b>Kinh - Male<br><b>Count: <\\/b>49 persons<br><b>Share of Province: <\\/b>32.7%\",\"<b>Province: <\\/b>Tuyen Quang (Total N=150)<br><b>Group: <\\/b>Minority - Male<br><b>Count: <\\/b>74 persons<br><b>Share of Province: <\\/b>49.3%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(44,127,184,0.8)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Male\",\"legendgroup\":\"Male\",\"showlegend\":false,\"xaxis\":\"x4\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.70000000000000007,0.70000000000000018],\"base\":[0.013986013986013986,0.034965034965034968],\"x\":[1,2],\"y\":[0.37062937062937062,0.58041958041958042],\"text\":[\"<b>Province: <\\/b>Yen Bai (Total N=143)<br><b>Group: <\\/b>Kinh - Male<br><b>Count: <\\/b>53 persons<br><b>Share of Province: <\\/b>37.1%\",\"<b>Province: <\\/b>Yen Bai (Total N=143)<br><b>Group: <\\/b>Minority - Male<br><b>Count: <\\/b>83 persons<br><b>Share of Province: <\\/b>58.0%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(44,127,184,0.8)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Male\",\"legendgroup\":\"Male\",\"showlegend\":false,\"xaxis\":\"x5\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.70000000000000007,0.70000000000000018],\"base\":[0,0],\"x\":[1,2],\"y\":[0.075342465753424653,0.068493150684931503],\"text\":[\"<b>Province: <\\/b>Bac Giang (Total N=146)<br><b>Group: <\\/b>Kinh - Female<br><b>Count: <\\/b>11 persons<br><b>Share of Province: <\\/b>7.5%\",\"<b>Province: <\\/b>Bac Giang (Total N=146)<br><b>Group: <\\/b>Minority - Female<br><b>Count: <\\/b>10 persons<br><b>Share of Province: <\\/b>6.8%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(254,178,76,0.8)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Female\",\"legendgroup\":\"Female\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.70000000000000007,0.70000000000000018],\"base\":[0,0],\"x\":[1,2],\"y\":[0.042553191489361701,0.1773049645390071],\"text\":[\"<b>Province: <\\/b>Ha Giang (Total N=141)<br><b>Group: <\\/b>Kinh - Female<br><b>Count: <\\/b>6 persons<br><b>Share of Province: <\\/b>4.3%\",\"<b>Province: <\\/b>Ha Giang (Total N=141)<br><b>Group: <\\/b>Minority - Female<br><b>Count: <\\/b>25 persons<br><b>Share of Province: <\\/b>17.7%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(254,178,76,0.8)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Female\",\"legendgroup\":\"Female\",\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.70000000000000007,0.70000000000000018],\"base\":[0,0],\"x\":[1,2],\"y\":[0.25,0.076388888888888895],\"text\":[\"<b>Province: <\\/b>Quang Ninh (Total N=144)<br><b>Group: <\\/b>Kinh - Female<br><b>Count: <\\/b>36 persons<br><b>Share of Province: <\\/b>25.0%\",\"<b>Province: <\\/b>Quang Ninh (Total N=144)<br><b>Group: <\\/b>Minority - Female<br><b>Count: <\\/b>11 persons<br><b>Share of Province: <\\/b>7.6%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(254,178,76,0.8)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Female\",\"legendgroup\":\"Female\",\"showlegend\":false,\"xaxis\":\"x3\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.70000000000000007,0.70000000000000018],\"base\":[0,0],\"x\":[1,2],\"y\":[0.073333333333333334,0.10666666666666667],\"text\":[\"<b>Province: <\\/b>Tuyen Quang (Total N=150)<br><b>Group: <\\/b>Kinh - Female<br><b>Count: <\\/b>11 persons<br><b>Share of Province: <\\/b>7.3%\",\"<b>Province: <\\/b>Tuyen Quang (Total N=150)<br><b>Group: <\\/b>Minority - Female<br><b>Count: <\\/b>16 persons<br><b>Share of Province: <\\/b>10.7%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(254,178,76,0.8)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Female\",\"legendgroup\":\"Female\",\"showlegend\":false,\"xaxis\":\"x4\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.70000000000000007,0.70000000000000018],\"base\":[0,0],\"x\":[1,2],\"y\":[0.013986013986013986,0.034965034965034968],\"text\":[\"<b>Province: <\\/b>Yen Bai (Total N=143)<br><b>Group: <\\/b>Kinh - Female<br><b>Count: <\\/b>2 persons<br><b>Share of Province: <\\/b>1.4%\",\"<b>Province: <\\/b>Yen Bai (Total N=143)<br><b>Group: <\\/b>Minority - Female<br><b>Count: <\\/b>5 persons<br><b>Share of Province: <\\/b>3.5%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(254,178,76,0.8)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Female\",\"legendgroup\":\"Female\",\"showlegend\":false,\"xaxis\":\"x5\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":80,\"r\":7.9701120797011216,\"b\":40.647571606475722,\"l\":47.023661270236623},\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":15.940224159402243},\"title\":{\"text\":\"Ethnic Concentration in Northern Vietnam's Informal Sector<br><sup>Spatial distribution across five provinces\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":19.128268991282692},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,0.18928571428571431],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,2.6000000000000001],\"tickmode\":\"array\",\"ticktext\":[\"Kinh\",\"Minority\"],\"tickvals\":[1,2],\"categoryorder\":\"array\",\"categoryarray\":[\"Kinh\",\"Minority\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.9850560398505608,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":12.7521793275218},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":\"\",\"hoverformat\":\".2f\"},\"annotations\":[{\"text\":\"Ethnic Group\",\"x\":0.5,\"y\":0,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":15.940224159402243},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"top\",\"annotationType\":\"axis\",\"yshift\":-23.910336239103373},{\"text\":\"Proportional Share in Province\",\"x\":0,\"y\":0.5,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":15.940224159402243},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-90,\"xanchor\":\"right\",\"yanchor\":\"center\",\"annotationType\":\"axis\",\"xshift\":-30.28642590286427},{\"text\":\"Bac Giang (N=146)\",\"x\":0.094642857142857154,\"y\":1,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":12.7521793275218},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"},{\"text\":\"Ha Giang (N=141)\",\"x\":0.29999999999999999,\"y\":1,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":12.7521793275218},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"},{\"text\":\"Quang Ninh (N=144)\",\"x\":0.50000000000000011,\"y\":1,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":12.7521793275218},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"},{\"text\":\"Tuyen Quang (N=150)\",\"x\":0.70000000000000007,\"y\":1,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":12.7521793275218},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"},{\"text\":\"Yen Bai (N=143)\",\"x\":0.90535714285714286,\"y\":1,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":12.7521793275218},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"}],\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-0.038652482269503546,0.8117021276595745],\"tickmode\":\"array\",\"ticktext\":[\"0%\",\"20%\",\"40%\",\"60%\",\"80%\"],\"tickvals\":[0,0.20000000000000004,0.40000000000000013,0.60000000000000009,0.80000000000000004],\"categoryorder\":\"array\",\"categoryarray\":[\"0%\",\"20%\",\"40%\",\"60%\",\"80%\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.9850560398505608,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":12.7521793275218},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":\"\",\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"layer\":\"below\",\"x0\":0,\"x1\":0.18928571428571431,\"y0\":0,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"layer\":\"below\",\"x0\":0,\"x1\":0.18928571428571431,\"y0\":0,\"y1\":25.5043586550436,\"yanchor\":1,\"ysizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"layer\":\"below\",\"x0\":0.21071428571428572,\"x1\":0.38928571428571429,\"y0\":0,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"layer\":\"below\",\"x0\":0.21071428571428572,\"x1\":0.38928571428571429,\"y0\":0,\"y1\":25.5043586550436,\"yanchor\":1,\"ysizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"layer\":\"below\",\"x0\":0.41071428571428575,\"x1\":0.58928571428571441,\"y0\":0,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"layer\":\"below\",\"x0\":0.41071428571428575,\"x1\":0.58928571428571441,\"y0\":0,\"y1\":25.5043586550436,\"yanchor\":1,\"ysizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"layer\":\"below\",\"x0\":0.61071428571428577,\"x1\":0.78928571428571437,\"y0\":0,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"layer\":\"below\",\"x0\":0.61071428571428577,\"x1\":0.78928571428571437,\"y0\":0,\"y1\":25.5043586550436,\"yanchor\":1,\"ysizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"layer\":\"below\",\"x0\":0.81071428571428572,\"x1\":1,\"y0\":0,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"layer\":\"below\",\"x0\":0.81071428571428572,\"x1\":1,\"y0\":0,\"y1\":25.5043586550436,\"yanchor\":1,\"ysizemode\":\"pixel\"}],\"xaxis2\":{\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,2.6000000000000001],\"tickmode\":\"array\",\"ticktext\":[\"Kinh\",\"Minority\"],\"tickvals\":[1,2],\"categoryorder\":\"array\",\"categoryarray\":[\"Kinh\",\"Minority\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.9850560398505608,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":12.7521793275218},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"domain\":[0.21071428571428572,0.38928571428571429],\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":\"\",\"hoverformat\":\".2f\"},\"xaxis3\":{\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,2.6000000000000001],\"tickmode\":\"array\",\"ticktext\":[\"Kinh\",\"Minority\"],\"tickvals\":[1,2],\"categoryorder\":\"array\",\"categoryarray\":[\"Kinh\",\"Minority\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.9850560398505608,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":12.7521793275218},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"domain\":[0.41071428571428575,0.58928571428571441],\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":\"\",\"hoverformat\":\".2f\"},\"xaxis4\":{\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,2.6000000000000001],\"tickmode\":\"array\",\"ticktext\":[\"Kinh\",\"Minority\"],\"tickvals\":[1,2],\"categoryorder\":\"array\",\"categoryarray\":[\"Kinh\",\"Minority\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.9850560398505608,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":12.7521793275218},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"domain\":[0.61071428571428577,0.78928571428571437],\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":\"\",\"hoverformat\":\".2f\"},\"xaxis5\":{\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,2.6000000000000001],\"tickmode\":\"array\",\"ticktext\":[\"Kinh\",\"Minority\"],\"tickvals\":[1,2],\"categoryorder\":\"array\",\"categoryarray\":[\"Kinh\",\"Minority\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.9850560398505608,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":12.7521793275218},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"domain\":[0.81071428571428572,1],\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":\"\",\"hoverformat\":\".2f\"},\"showlegend\":false,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":12.7521793275218}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"6ea869e943aa\":{\"x\":{},\"y\":{},\"fill\":{},\"text\":{},\"type\":\"bar\"}},\"cur_data\":\"6ea869e943aa\",\"visdat\":{\"6ea869e943aa\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(plotly)\nlibrary(scales)\n\nplot_data_final <- clean_df %>%\n  group_by(province, race, gender) %>%\n  summarise(count = n(), .groups = \"drop\") %>%\n  group_by(province) %>%\n  mutate(\n    prov_total = sum(count),\n    percentage = count / prov_total,\n    tooltip_text = paste0(\n      \"<b>Province: </b>\", province, \" (Total N=\", prov_total, \")<br>\",\n      \"<b>Group: </b>\", race, \" - \", gender, \"<br>\",\n      \"<b>Count: </b>\", count, \" persons<br>\",\n      \"<b>Share of Province: </b>\", percent(percentage, accuracy = 0.1)\n    ),\n    facet_label = paste0(province, \" (N=\", prov_total, \")\")\n  )\n\np_final <- ggplot(plot_data_final, \n                  aes(x = race, \n                      y = percentage, \n                      fill = gender, \n                      text = tooltip_text, \n                      group = gender)) +\n  geom_bar(stat = \"identity\", position = \"stack\", width = 0.7, alpha = 0.8) +\n  facet_wrap(~facet_label, nrow = 1) +\n  scale_y_continuous(labels = scales::percent_format()) +\n  scale_fill_manual(values = c(\"Male\" = \"#2c7fb8\", \"Female\" = \"#feb24c\")) +\n  theme_minimal(base_size = 12) +\n  labs(\n    title = \"Workforce Composition by Region\",\n    x = \"Ethnic Group\",\n    y = \"Proportional Share in Province\"\n  ) +\n  theme(legend.position = \"none\", panel.spacing = unit(1, \"lines\"))\n\nggplotly(p_final, tooltip = \"text\") %>%\n  layout(\n    title = list(text = \"Ethnic Concentration in Northern Vietnam's Informal Sector<br><sup>Spatial distribution across five provinces\"),\n    margin = list(t = 80)\n  )\n```\n:::\n\n:::\n\n**Observation** : \n\nThe visualization reveals a balanced sampling strategy ($N \\approx 141$–$150$ per region). A dominant pattern emerges regarding ethnicity: Minority groups constitute the overwhelming majority of informal labourers in Ha Giang, Tuyen Quang, and Yen Bai. In these remote provinces, ethnicity is a near-absolute predictor of informal employment. \n\nInterestingly, gender distribution shows no consistent geographic pattern. While males dominate the workforce (over 80% across all facets), the female participation rate fluctuates unpredictably between provinces and ethnic groups without a distinct trend. This suggests that while informal labour is heavily \"gendered\" toward men, female participation is likely driven by localized micro-economic conditions or household-specific needs, such as the necessity for supplemental income, rather than provincial-level geographic characteristics.",
    "supporting": [
      "TE01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.9/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/plotly-binding-4.11.0/plotly.js\"></script>\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.2/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.2/js/crosstalk.min.js\"></script>\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}